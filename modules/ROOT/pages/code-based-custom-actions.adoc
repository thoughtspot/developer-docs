= Code based custom actions

:page-title: Code based custom actions
:page-pageid: code-based-custom-action
:page-description: You can add custom buttons or menu items in your ThoughtSpot code to the ThoughtSpot UI to let your application users to analyze insights and trigger an action on the data.

Code-based custom actions are custom menu items that you define within the Visual Embed SDK.

These custom actions add a new menu item to one of the following UI elements in an Answer, Liveboard, visualization, or in the Spotter interface:

* the primary menu bar (except for Spotter)
* the **More** options menu image:./images/icon-more-10px.png[the more options menu]
* the contextual menu that appears when a user right-clicks on an Answer or visualization (not for Liveboard)

=== Contents of a code based custom action interface

Code based custom actions work for........

* Display name for the custom action
* Unique identifier for the action
* Position where the action should be rendered
* The target object type where the action applies
* Optional metadata-based filtering for actions
** Applicable Liveboard GUIDs
** Applicable Answer GUIDs
** Applicable Viz GUIDs
** Data model GUIDs
* Restrict visibility to specific orgs
* Restrict visibility to specific groups


=== Code based custom action for Liveboards

When liveboard Id is passed only to show custom action at liveboard level.

[source,javascript]
----
const customActions = [
    {
        name: 'CA1',
        id: 'ca1',
        position: CustomActionPosition.PRIMARY,
        target: CustomActionTarget.LIVEBOARD
        metadataIds: {
            liveboardIds: ['lb1'],
        },
    },
];

To trigger the custom flow -
embed.on(EmbedEvent.CustomAction, (payload) => {
// Implement your own custom flow
console.log('payload', payload);
})
----

When liveboard level custom action needs to be shown to users belonging to specific groups or specific orgs.

[source,javascript]
----
const customActions = [
{
name : "CA1",
id: "ca1",
position: CustomActionPosition.PRIMARY,
target: CustomActionTarget.LIVEBOARD,
metadataIds: {
liveboardId: ['lb1'],
},
groupId: ['grp1'],
orgId: ['org1'],
}
]
----

=== Code based custom action for Visualizations

When liveboard Id is passed in that case custom actions will be shown to all the visualizations of the liveboard.

[source,javascript]
----
const customActions = [
    {
        name: 'CA1',
        id: 'ca1',
        position:CustomActionPosition.PRIMARY,
	  target: 'VIZ'
        metadataIds: {
            liveboardIds: ['lb1']
        },
    },
];
----

When vizId or answerId is passed, in that case custom actions will be shown to the specific viz whose vizId has been passed.

[source,javascript]
----
const customActions = [
    {
        name: 'CA1',
        id: 'ca1',
        position: CustomActionPosition.PRIMARY,
	  target: 'VIZ'
        metadataIds: {
            vizIds: ['viz1']
        },
    },
];
----

When liveboardId and vizId both are passed, in that scenario we will do the union of all the visualizations present in the liveboard and the visualizations whose vizId has been passed.

In this scenario we will show custom action on all the vizzes of lb2 since liveboard id is present and for lb1, we will show only custom action on viz11

[source,javascript]
----
const customActions = [
    {
        name: 'CA1',
        id: 'ca1',
        position: CustomActionPosition.PRIMARY,
	  target: 'VIZ',
        metadataIds: {
            liveboardIds: ['lb2'],
		vizIds: ['viz21', 'viz11']
        },
    },
];
----

When groupId or orgId or both are passed, in that case custom actions will be shown given viz should be present in that orgId and user who is using should be part of that group.

In this scenario we will show custom action for the user who is part of org1 and grp1, on all the vizzes of lb2 since liveboard id is present and for lb1, we will show only custom action on viz11
[source,javascript]
----
const customActions = [
    {
        name: 'CA1',
        id: 'ca1',
        position: CustomActionPosition.PRIMARY,
	  target: 'VIZ',
        metadataIds: {
            liveboardIds: ['lb2'],
		vizIds: ['viz21', 'viz11']
        },
        groupId: ['grp1'],
        orgId: ['org1'],
    },
];
----
