= Users and group privileges
:toc: true

:page-title: Users and group privileges
:page-pageid: api-user-management
:page-description: You can manage users and user groups using REST APIs

To provide access to ThoughtSpot content or define role-based privileges, you need to add users and groups in ThoughtSpot. You can create user accounts and user groups using REST API endpoints.

== User creation and update

You can create users using the xref:user-api.adoc#create-user[/tspublic/v1/user/] REST API endpoint and update user profiles via a xref:user-api.adoc#update-user[PUT call]. While you can xref:user-api.adoc#delete-user[delete users], it is preferable to xref:user-api.adoc#deactivate-user[deactivate the user] instead, which maintains the user's references within the system. 

When configuring xref:configure-saml.adoc[SAML SSO] in ThoughtSpot UI, you can select the *Automatically add SAML users to ThoughtSpot upon first authentication* option, which will use the values in the SAML assertion to create a user if they do not exist. ThoughtSpot can also add users to groups sent within the SAML assertion. To enable and configure the SAML groups capabilities, contact your ThoughtSpot team.

By default, ThoughtSpot sends e-mail messages to a new user and enables onboarding workflows when they first log in, even when you are embedding ThoughtSpot content. To alter this behavior at a system-wide level, you need to xref:customize-email-settings.adoc[Customize the onboarding settings]. The xref:user-api.adoc#update-user[update user REST API] also allows setting onboarding experience values for an individual user through the JSON object of the `content` argument. If you need to modify the default behavior beyond the available UI options, contact your ThoughtSpot team.

[NOTE]
====
ThoughtSpot supports the local management of user profiles. For initial development and testing purposes, you can create users in ThoughtSpot and manage their profiles locally. However, in large production environments, avoid creating local user profiles to reduce the administration overhead.
====

=== User states
The user state describes the current state of the user account in its ThoughtSpot instance. The following are the user states in ThoughtSpot:

* ACTIVE
+
This is for currently active users who can login to their ThoughtSpot instance with their valid credentials.
* INACTIVE
+
This is for users who have left the organization and do not have to access ThoughtSpot instance anymore. If required, such users can be activated by resetting the password.
* PENDING
+
This is for users who have been sent a ThoughtSpot account activation email but have not yet logged in.
* LOCKED
+
This is for users who have made multiple incorrect login attempts. The account gets locked for an hour, after which the user can try to login again.
* EXPIRED
+
This is for the free trial customers. The state is set to EXPIRED once the free trial time period is over.

=== User state management with IAMv2

ThoughtSpot introduces a new user state,*SUSPENDED*, for embedded users on IAMv2. With this enhancement, these users do not require a password reset when transitioning between states such as ACTIVE, EXPIRED, or INACTIVE. It also enables seamless migration from IAMv1 to IAMv2 for embedded users.

With IAM v2, users need to provide an email attribute for successful user creation. If no email is provided at the time of user creation, the admin email will be populated for that user.

==== Key features of the SUSPENDED user state

The addition of the SUSPENDED state tries to address the limitations of the current IAM v2 implementation. A few important features of the SUSPENDED state are:

* Users in the SUSPENDED state will not be able to log in to their ThoughtSpot instance. This provides an effective way to manage access without compromising security.
* Transitioning a user from SUSPENDED to ACTIVE or PENDING does not require a password reset.
* While creating or updating a user to the EXPIRED or INACTIVE state using REST APIs, the user will be suspended instead. This change will effectively block user logins without altering existing behavior.

==== Affected APIs
The SUSPENDED state affects the following API endpoints:

* Create user REST API xref:user-api.adoc#create-user[v1] and xref:rest-api-v2-reference.adoc#_users[v2]
+
You can create a user in the SUSPENDED state using the create user REST API.
* Update user REST API xref:user-api.adoc#update-user[v1] and xref:rest-api-v2-reference.adoc#_users[v2]
+
You can change the state of an ACTIVE or PENDING user to SUSPENDED or reactivate a SUSPENDED user to the ACTIVE or PENDING state using the update user REST API.


==== Common state transitions
Within the IAM v2 framework, the common user state transitions include:

* ACTIVE to EXPIRED
* ACTIVE to INACTIVE
* ACTIVE to SUSPENDED
* LOCKED to ACTIVE
* SUSPENDED to ACTIVE
* SUSPENDED to PENDING

==== Options for user state in the UI
There is also a UNSUSPEND user button on the user dashboard of the *Admin* page. This button is available for all users in the SUSPENDED state.
Upon clicking this button, the userâ€™s state will transition from SUSPENDED to ACTIVE or PENDING.

image::./images/unsuspend.png[Unsuspended state]



== User group creation and update
Groups can be created via the xref:group-api.adoc#create-group[/tspublic/v1/group/] REST API endpoint. 

xref:api-user-management.adoc#group-privileges[Group privileges] are set directly on groups, either at group creation time, an xref:group-api.adoc#update-group[update call], or through the xref:group-api.adoc#add-privilege[add privilege] and xref:group-api.adoc#remove-privilege[remove privilege] methods.

== User association to groups
Users can can be added to specific groups when the user is being created, or you can use the xref:group-api.adoc#add-user-to-group[add a user to a group endpoint]. 

The xref:group-api.adoc#addMembers[group/addmemberships] endpoint allows adding multiple users to multiple groups in a single request.

The set of members within a group can be requested using the xref:group-api.adoc#get-users-group[/group/listuser/{groupid}] or xref:group-api.adoc#get-usersInGroup[/group/{groupid}/users] endpoints. 

You can remove a user from a group xref:group-api.adoc#delete-user-assoc[individually] or xref:group-api.adoc#removeMembers[remove a list of users] from many groups at once.

== Access control (sharing)
The content a user can access is determined by content *shared* directly to the user or the groups they belong to. It is easier to manage and audit sharing through groups rather than at the individual user level. 

Sharing can be accomplished through the UI or the xref:security-api.adoc#share-object[/security/share REST API endpoint], including removing sharing from a user or group.  

[#group-privileges]
== Group privileges

Each user group includes a set of privileges for its users. When a user is assigned to a group in ThoughtSpot, the default privileges associated with a group are assigned to its users. The group privileges allow users belonging to a group to perform specific operations and access workflows. If a user belongs to more than one group, they will have the highest level of privileges from all the groups they belong to.


[NOTE]
====
If a user group belongs to another user group, it inherits privileges from its parent group.
====

include::{path}/group-privileges.adoc[]

[NOTE]
====
ThoughtSpot also has a default group called `All`. When you create new users in ThoughtSpot, they are automatically added to `All`. By default, the members of the `All` group do not have permission to download or upload data. To add these privileges, you can use the Group API endpoints.
====


