= Agentic MCP server integration
:toc: true
:toclevels: 3

:page-title: MCP integration
:page-pageid: mcp-integration
:page-description: Learn how to use the ThoughtSpot Model Context Protocol (MCP) server to interact with ThoughtSpot data via MCP tools and AI APIs and get relevant questions and answers for a given query and create Liveboards at runtime.

ThoughtSpot’s Agentic Multi-Client Protocol (MCP) Server enables integrating ThoughtSpot analytics directly into any AI agent, custom chatbot, or LLM-based systems and platforms that support MCP. It acts as a connector between the ThoughtSpot instance and external AI client, and provides a set of tools for interacting with ThoughtSpot’s data and its analytics capabilities programmatically.

The MCP tools of the Agentic MCP Server support the following functions:

* Ask natural language questions and get data in a structured format from ThoughtSpot
* Retrieve relevant analytical questions based on user queries
* Create a Liveboard with the answers generated from the queries
* Get data source recommendations based on a user's query and intent

== Integration overview

The Agentic MCP Server integration requires the following core components and authentication framework:

MCP Server::
The MCP Server provides a tools wrapper with a discoverable interface for agentic analytics. It exposes a set of tools to external agents to interact with ThoughtSpot's resources, data, and analytical capabilities. The MCP Server includes an orchestration layer that determines which tools to invoke based on the incoming queries and user intent. The MCP Server can be hosted by ThoughtSpot or by customers in their own environment.

MCP tools, resources, and AI APIs::
MCP tools are the actions that the MCP Server exposes to the agent for interaction with ThoughtSpot. Currently, the MCP Server supports the following tools:

* `ping` to test connection to ThoughtSpot
* `getRelevantQuestions` to get relevant analytical questions +
The `getRelevantQuestions` tool calls xref:spotter-apis.adoc#_get_relevant_questions[/api/rest/2.0/ai/relevant-questions/] API and gets relevant data questions for a given data context by breaking down a user's query.
* `getAnswer` to execute the queries and fetch data +
The `getAnswer` tool calls xref:spotter-apis.adoc#_send_a_question_and_generate_streaming_responses[/api/rest/2.0/ai/agent/converse/sse] API and generates answers and insights for a given data context.
* `createLiveboard` to create a Liveboard in ThoughtSpot +
The `createLiveboard` tool calls the Liveboard creation workflow and creates a Liveboard with the answers generated from user's query.
* `getDataSourceSuggestions` to get data source suggestions +
Based on the type of data that users want to fetch, `getDataSourceSuggestions` gets a list of data source recommendations. Currently, `getDataSourceSuggestions` is not exposed as an MCP tool and is available as an MCP `resource`. To get data source suggestions, the user or MCP client must have at least view access to ThoughtSpot data sources.

MCP host/client::
The external system or application environment with AI Agent, Claude, OpenAI, or a custom chatbot that acts as a user interface, orchestrates interaction with ThoughtSpot MCP Server, and enables agentic workflows.

Configuration settings to enable the integration::
Integration requires configuration, typically via a config file, to specify server addresses, credentials, and other connection details.

Authentication and security settings::
* Access to ThoughtSpot instance: +
For MCP Server connection, users require access to a ThoughtSpot instance. ThoughtSpot administrators can use the SSO framework with SAML or OAuth token-based authentication methods to authenticate and sign in the users. +
To get answers to their data queries, your application users require at least view access to ThoughtSpot data sources. To generate an Answer or to create Liveboard, users
* CSP and CORS settings: +
To secure communication between the MCP client and the ThoughtSpot instance, administrators must add the MCP Server URL to CSP (Content Security Policy) and CORS (Cross-Origin Resource Sharing) allowlists in ThoughtSpot.
* SAML redirect settings: +
For SAML SSO users, the SAML redirect domain configuration is required to ensure that users are redirected to an allowed and trusted domain after they are authenticated.
* Client connection configuration: +
MCP Server integration also requires configuration on the client side, typically via a config file, to include the MCP Server addresses, credentials, and other details.

=== How it works

When the MCP Server integration is enabled, your host app connects to ThoughtSpot and enables the following workflow:

. User initiates a request. +
The user sends a query to get data from a specific ThoughtSpot data model or context.
. AI agent receives the request and discovers the MCP tools +
The agent discovers MCP tools available in its environment and processes the request to the MCP Server, specifying the data model or context and the user's query.
. MCP Server receives the request and executes actions via tools +
The MCP Server executes tools and triggers API requests to ThoughtSpot to break down the user's query into relevant questions, get information for the specified data context, or create an artifact.
. The MCP Server sends the response to the MCP host.
. The agent receives the response and constructs the output +
The agent receives the response from the MCP host, constructs the output, and presents it to the user.
. User receives the response +
The user can refine the analysis or choose a direction for further exploration. +
For example, after receiving relevant questions and answer, the user can send follow-up questions or send a Liveboard creation request.

The following figure illustrates the sequence of workflows in a typical MCP Server integration setup:

[.widthAuto]
image::./images/mcp-integration.png[MCP integration]

== Get started
To get started with the integration, complete the steps described in the following sections. In this article, we'll integrate ThoughtSpot MCP Server with Claude and enable agentic interaction and workflows.

=== Before you begin

Before you begin, verify if your application setup has the following:

* Node.js version 22 or later is installed.
* A ThoughtSpot instance with 10.11.0.cl or later release version. You'll need administrator credentials to configure security settings or set up token-based authentication for your application users.
* Your application users must have at least view access to the data source objects to query data and get answers.
* Row-level and column-level security rules are configured for data security and access control.

=== Configure security settings on ThoughtSpot

To allow the secure communication between the MCP Server and your ThoughtSpot instance, configure the following settings:

. On your ThoughtSpot instance, navigate to *Develop* > *Customizations* > *Security Settings*.
. Add the MCP Server domain to CSP and CORS allowlists.
. If your setup uses SAML SSO logins, add the MCP Server domain to the SAML redirect domain allowlist.

=== Add MCP Server to the MCP client's config

If your MCP client supports remote MCP Servers, add the MCP Server URL to the client's config file.

MCP clients such as Claude Desktop, Windsurf, and Cursor do not support remote MCP Servers. In such a case, add the URL with arguments shown in this example:

[source,JSON]
----
{
  "mcpServers": {
    "ThoughtSpot": {
      "command": "npx",
      "args": [
         "mcp-remote",
         "https://agent.thoughtspot.app/mcp"
      ]
    }
  }
}

----

After updating the config file:

. When prompted to connect your ThoughtSpot instance, add the URL of your application instance and complete authentication.
. Restart your MCP client to load the new configuration.
+
If the connection is successful, you'll see an option to connect to ThoughtSpot and choose the data context. +
For example, the Claude Desktop shows the *Add to ThoughtSpot* as shown in the following figure:
+
[.bordered]
[.widthAuto]
image::./images/claudeDesktop.png[Claude Desktop]

. Verify if the MCP tools are available. +
For example, on Claude Desktop, click the Search and tools icon to view the MCP tools.

+
[.bordered]
[.widthAuto]
image::./images/mcp-tools-claude.png[Claude Desktop]

You can adjust tool access, resources, instructions to data models, object permissions, and user privileges as needed. To get insights, the user requires view access to the data source objects and data download privilege.

=== Verify the query and response workflow

* Select a data source to set the context of your query. +
For example, on Claude Desktop, click the `+` icon and select a data source.

+
[.bordered]
[.widthAuto]
image::./images/datasource-selection.png[Claude Desktop]

* Ask an analytics question to trigger the query and response workflow.
* Verify if the AI agent on your MCP client gets relevant data questions from ThoughtSpot and generates an Answer.
+
[.bordered]
[.widthAuto]
image::./images/query-response-claude.png[Claude query response]

+
[.bordered]
[.widthAuto]
image::./images/query-response-claude2.png[Claude query response 2]

* Try sending a query to create a Liveboard and verify if a Liveboard is created on your ThoughtSpot instance.

+
[.bordered]
[.widthAuto]
image::./images/create-lb-claude.png[Liveboard creation]


== Configuration considerations and best practices

* Users must have at least view access to the data source. Otherwise, it may lead to empty results.
* Ensure that data is modeled. Large or complex data sources may impact response time.
* Streaming responses require client support for real-time updates. Ensure that your system is available to receive and process data.
* Each conversation is session-based. Ensure that session IDs are managed correctly in your integration.

== Additional resources

* Check the link:https://github.com/thoughtspot/mcp-server[MCP Server GitHub repo, window=_blank] for implementation instructions.
* Check your MCP client's documentation for instructions on how to connect to MCP Servers.
* To understand ThoughtSpot agentic analytics capabilities and AI APIs, refer to the following documentation:

** link:https://docs.thoughtspot.com/cloud/latest/spotter[Spotter Documentation]
** link:https://docs.thoughtspot.com/cloud/latest/spotter-agent[Spotter Agent Documentation]
** xref:spotter-apis.adoc[Spotter AI APIs]
* In case of issues with connection or authentication, refer to the link:https://github.com/thoughtspot/mcp-server?tab=readme-ov-file#troubleshooting[troubleshooting steps^].